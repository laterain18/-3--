## 摇太阳
### 此仓库用于存放七牛校招的议题3代码及demo
---
#### 1. 项目介绍
本项目使用TI MSPM0G3507作为控制芯片，融合光电管颜色识别、TOF激光测距、相机视觉，实现了沿指定颜色路径行驶+避障+视觉辅助感知。同时支持WIFI图像传输。

实现的题目要求如下：完成所有基础要求，完成2要求，完成1、3的大部分要求。

---

#### 2. 具体要求实现方案
##### 2.1 寻迹方案：
使用八路灰度传感器获取赛道的灰度值并通过ADC采集，通过人机交互确定二值化阈值做到不同颜色赛道的二值化。二值化之后根据八路颜色值获取偏差进行PID运算通过PWM控制小车进行移动。
##### 2.2 断路方案：
由于此次断路较为简单，只需要硬打角度即可实现，为简化开发流程便不做特殊处理了。
##### 2.3 视觉辅助感知：
此次视觉任务较为简单，故本人没有训练模型，直接使用阈值搜索固定颜色后判断位置即可辅助判断是否需要避障。
- 根据阈值区间搜索固定颜色
- 如果找到了则将IO口拉高告知控制模块允许避障
##### 2.4 避障方案：
通过TOF采集距离数据，根据距离数据和路障的色块是否相符进行判断是否需要避障。
避障的控制过程分为3个阶段：
- 车头向右侧旋转后向左侧镜像旋转实现S型曲线避障
- 车头向内侧旋转一定角度后完成绕行
- 小车以一定弧线继续旋转直到灰度传感器识别到赛道后继续寻迹
##### 2.5 WIFI图像传输：
1. WiFi 连接：
使用 network.WLAN 建立 WiFi 连接，定义 SSID 和密码，设置 15 秒超时机制，获取设备 IP 地址，确保网络可用。
2. 数据捕获线程：
创建独立线程 capture_thread，通过 sensor.snapshot() 捕获图像，将其压缩为 JPEG 格式（compressed(quality=50) 优化大小），存储到 frame_queue。使用 queue_lock 同步访问，每 10 帧计算并打印 FPS，定期调用 gc.collect() 清理内存。
3. MJPEG 服务器与处理：
创建 TCP 服务器（socket.socket），绑定 8080 端口，监听 5 个连接。定义 mjpeg_handler 函数，响应 HTTP 请求，发送 multipart/x-mixed-replace; boundary=frame 格式的 MJPEG 流。从 frame_queue 弹出 JPEG 数据，添加边界和头部信息（Content-Type: image/jpeg 和 Content-Length），通过客户端 socket 发送，每秒计算并打印发送 FPS。
4. 主循环与资源管理：
主线程接受客户端连接，启动新线程处理每个连接。使用 running 标志支持 KeyboardInterrupt，在 finally 块中清理资源（停止传感器、关闭服务器、断开 WiFi、deinit MediaManager）。

---

#### 3. 总结
##### 3.1 不足之处与优化方案：
- 由于赛阈值搜索准确度已经较高，没有训练模型，只使用固定颜色进行视觉辅助，鲁棒性有待提高。可训练YOLO模型提升鲁棒性。
- 断路部分由于要求较为简单，题目要求10CM以上，实测硬打角度依赖灰度传感器扫到线即可寻迹，但考虑扩展性与稳定性可以优化为惯性导航方案或者视觉辅助方案，我之前的项目都有做这些处理，但是为了简化开发没有进行移植适配使用。
- 实验室设备简陋并且只有我一个人完成赛道布置和各类任务，没有将赛道难度拉的很高，尤其是在避障方面，没有赛道外的路障演示部分展示视觉辅助避障的优势。
- 视觉方面偷懒只用了个IO口反馈视觉是否满足避障要求，可优化为串口或者其他通讯方式，便于升级各种功能。
- 由于时间问题，车模的选择是直接用的电赛小车，速度方面比较慢，可升级为智能车竞赛专用车模。
##### 3.2 自我评价：

由于秋招季的测评、笔试和面试任务繁重，我每天只能挤一个小时专注于赛题的开发。对于这个项目，我并未能在各个方面实现突出表现，但考虑到有限的开发时间，我认为目前的完成度尚属可以接受。同时，我也意识到存在许多更优化的方法和改进空间，值得未来进一步实践与实施。

结合七牛云的企业文化，我特别认同“拥抱变化”和“开放协作”的理念。在项目开发中，我主动适应了技术栈和需求的快速变化，并积极使用AI工具加速开发，提升成果质量。“专注匠心”和“怀抱纯粹之心”激励我在有限时间内尽力追求代码的可靠性和效率，而“专注价值实现，朝着目标不断迈进”则让我始终聚焦于项目的核心目标，力求交付实用成果。尽管时间紧迫，我仍努力保持“做一个简单的人”的心态，注重清晰的逻辑和简洁的实现。

如果有幸通过此轮筛选，我希望能够继续深入优化项目，融入更多匠心精神，并通过开放协作与团队共同探索更优解决方案。
我期待在七牛云的文化氛围中成长，持续提升自己，为实现更大的价值贡献力量。感谢评审对我的理解与支持！


